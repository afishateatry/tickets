<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>–û —Å–æ–±—ã—Ç–∏–∏</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#f3f4f6;--card:#fff;--text:#0b0b0c;--muted:#6b7280;--line:#e5e7eb;--shadow:0 18px 40px rgba(0,0,0,.12);}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text);}
    .wrap{max-width:900px;margin:0 auto;padding:12px 12px 40px;}
    .top{display:flex;gap:10px;justify-content:space-between;align-items:center;margin:10px 0 12px;}
    a.pill{display:inline-flex;gap:8px;align-items:center;padding:10px 12px;border:1px solid var(--line);border-radius:999px;background:#fff;color:var(--text);text-decoration:none;font-weight:800;font-size:14px}
    .card{background:#fff;border:1px solid var(--line);border-radius:20px;box-shadow:var(--shadow);overflow:hidden;}
    .head{display:grid;grid-template-columns:140px 1fr;gap:16px;padding:16px;border-bottom:1px solid var(--line);}
    .poster{width:140px;height:140px;border-radius:14px;overflow:hidden;background:#111;box-shadow:0 10px 18px rgba(0,0,0,.15)}
    .poster img{width:100%;height:100%;object-fit:cover;display:block}
    .h1{font-size:40px;font-weight:900;line-height:1.05;margin:4px 0 8px}
    .sub{font-size:16px;font-weight:800}
    .sub span{display:block;font-weight:700;color:var(--muted);margin-top:4px}
    .buy{display:inline-flex;align-items:center;justify-content:center;width:min(520px,100%);height:66px;background:linear-gradient(180deg,#1a1a1b,#000);color:#fff;border:none;border-radius:12px;font-weight:900;font-size:20px;cursor:pointer;text-decoration:none;box-shadow:0 16px 30px rgba(0,0,0,.18)}
    .content{padding:18px;}
    h2{margin:0 0 14px;font-size:40px;font-weight:900}
    .kv{font-size:18px;line-height:1.55;margin-bottom:18px}
    .kv b{font-weight:900}
    .kv div{margin:6px 0}
    .desc{font-size:18px;line-height:1.7;color:#374151;white-space:pre-wrap}
    @media(max-width:560px){
      .head{grid-template-columns:120px 1fr}
      .poster{width:120px;height:120px}
      .h1{font-size:34px}
      h2{font-size:36px}
    }
  </style>
</head>
<body>
<div class="wrap">
  <div class="top">
    <a class="pill" href="index.html">‚Üê –ê—Ñ–∏—à–∞</a>
    <a class="pill" href="wallet.html">üí≥ –ö–æ—à–µ–ª—ë–∫</a>
  </div>

  <div class="card">
    <div class="head">
      <div class="poster"><img id="poster" alt=""></div>
      <div>
        <div class="h1" id="title">...</div>
        <div class="sub" id="meta">...<span id="venue">...</span></div>
        <a class="buy" id="goBuy" href="buy.html">–ö—É–ø–∏—Ç—å</a>
        <div style="color:#6b7280;font-weight:800;font-size:14px;margin-top:10px">
          –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ö–µ–º—É –∑–∞–ª–∞ ‚Üí –≤—ã–±–æ—Ä –º–µ—Å—Ç ‚Üí –æ–ø–ª–∞—Ç–∞ —Å –∫–æ—à–µ–ª—å–∫–∞
        </div>
      </div>
    </div>

    <div class="content">
      <h2>–û —Å–æ–±—ã—Ç–∏–∏:</h2>
      <div class="kv" id="about"></div>

      <h2>–ê–∫—Ç—ë—Ä—Å–∫–∏–π —Å–æ—Å—Ç–∞–≤:</h2>
      <div class="kv" id="cast"></div>

      <h2>–û–ø–∏—Å–∞–Ω–∏–µ:</h2>
      <div class="desc" id="desc"></div>
    </div>
  </div>
</div>

<script>
/** ========= STORAGE ========= */
const K = {
  EVENTS:"THEATRE_EVENTS_V2",
  HIDDEN:"THEATRE_HIDDEN_EVENTS_V2",
};

/** ========= HELPERS ========= */
function qs(k){ return new URLSearchParams(location.search).get(k); }
function formatRU(isoDate){
  const [y,m,d]=String(isoDate||"").split("-");
  if(!y) return "";
  return `${d}.${m}.${y}`;
}
function seededRand(str){
  let h=2166136261>>>0;
  for(let i=0;i<str.length;i++){ h^=str.charCodeAt(i); h=Math.imul(h,16777619); }
  return ()=>{ h+=h<<13; h^=h>>>7; h+=h<<3; h^=h>>>17; h+=h<<5; return ((h>>>0)%100000)/100000; };
}
function rangeToEndOfMonth(){
  const now=new Date();
  const start=new Date(now.getFullYear(),now.getMonth(),now.getDate());
  const end=new Date(now.getFullYear(),now.getMonth()+1,0);
  return {start,end};
}
function iso(d){ return d.toISOString().slice(0,10); }
function loadEvents(){
  return JSON.parse(localStorage.getItem(K.EVENTS)||'{"events":[]}');
}
function saveEvents(v){
  localStorage.setItem(K.EVENTS, JSON.stringify(v));
}
function hiddenSet(){
  return new Set(JSON.parse(localStorage.getItem(K.HIDDEN)||"[]"));
}

/** ========= SEED (–µ—Å–ª–∏ –≤–¥—Ä—É–≥ –æ—Ç–∫—Ä—ã–ª–∏ show.html –Ω–∞–ø—Ä—è–º—É—é) ========= */
function seedEventsIfMissing(){
  const cur = loadEvents();
  if(cur.events && cur.events.length) return;

  const titles = [
    "–î—è–¥—è –í–∞–Ω—è","–ì–µ—Ä–æ–π –Ω–∞—à–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏","–õ–æ–Ω–¥–æ–Ω —à–æ—É","–ú–µ—á—Ç—ã –æ–∂–∏–≤–∞—é—Ç","–ñ–µ–Ω–∏—Ç—å–±–∞ –§–∏–≥–∞—Ä–æ",
    "–¢—ë–º–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞","–ì–æ—Ä–æ–¥ –±–µ–∑ —Å–Ω–∞","–ü–∏—Å—å–º–∞ –≤ —Ç–∏—à–∏–Ω—É","–ù–æ—á–Ω–æ–π —ç–∫—Å–ø—Ä–µ—Å—Å","–ö–æ—Ä–æ—Ç–∫–∞—è –ø—Ä–∞–≤–¥–∞",
    "–°–µ–¥—å–º–æ–π —Ä—è–¥","–°–≤–µ—Ç —Å–æ —Å—Ü–µ–Ω—ã","–¢–æ–Ω–∫–∞—è –ª–∏–Ω–∏—è","–ü–æ—Ä—Ç—Ä–µ—Ç –≤–µ—Ç—Ä–∞","–°—Ç—Ä–∞–Ω–Ω—ã–π –≤–µ—á–µ—Ä",
    "–¢—Ä–∏ —à–∞–≥–∞ –¥–æ –≤–µ—Å–Ω—ã","–í–Ω—É—Ç—Ä–∏ –º—É–∑—ã–∫–∏","–¢–µ–∞—Ç—Ä —Ç–µ–Ω–µ–π","–û—Å–∫–æ–ª–∫–∏ –ø–∞–º—è—Ç–∏","–ù–µ–≤–∏–¥–∏–º—ã–π –¥–∏–∞–ª–æ–≥",
  ];

  const posters = [
    "https://images.unsplash.com/photo-1529156069898-49953e39b3ac?auto=format&fit=crop&w=800&q=70",
    "https://images.unsplash.com/photo-1520697830682-bbb6e85e2b0d?auto=format&fit=crop&w=800&q=70",
    "https://images.unsplash.com/photo-1521336575822-6da63fb45455?auto=format&fit=crop&w=800&q=70",
    "https://images.unsplash.com/photo-1515168833906-d2a3b82b302a?auto=format&fit=crop&w=800&q=70",
    "https://images.unsplash.com/photo-1507924538820-ede94a04019d?auto=format&fit=crop&w=800&q=70",
    "https://images.unsplash.com/photo-1526481280695-3c687fd5432c?auto=format&fit=crop&w=800&q=70",
    "https://images.unsplash.com/photo-1508214751196-bcfd4ca60f91?auto=format&fit=crop&w=800&q=70"
  ];

  const descriptions = [
`–¢—ã —Ç–æ—Ç, –≤–æ —á—Ç–æ —Ç—ã –≤–µ—Ä–∏—à—å. –ù–æ –Ω–∞—Å–∫–æ–ª—å–∫–æ –∑—Ä—è—á–∞ –¥—É—à–∞ –∏ –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–ª–µ–ø—ã –≥–ª–∞–∑–∞?
–ö—É–¥–∞ –º–æ–∂–µ—Ç –∑–∞–≤–µ—Å—Ç–∏ –≤–µ—Ä–∞ –∏ —á—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã —Å–ª–µ–ø–æ–π –ø—Ä–æ–∑—Ä–µ–ª. –ú—É—á–∏—Ç–µ–ª—å–Ω—ã–π –∏ —Å–ª–æ–∂–Ω—ã–π –ø—É—Ç—å
–æ—Ç –≤–æ–ø—Ä–æ—Å–∞ –∫ –æ—Ç–≤–µ—Ç—É –ø—Ä–æ—Ö–æ–¥—è—Ç –≥–µ—Ä–æ–∏, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—ã—à–∏—Ç –ø—Ä–∞–≤–¥—É –ø–æ-—Å–≤–æ–µ–º—É.
–≠—Ç–æ—Ç —Å–ø–µ–∫—Ç–∞–∫–ª—å ‚Äî –ø—Ä–æ –≤–ª–∞—Å—Ç—å –ø—Ä–∏–≤—ã—á–µ–∫, –ø—Ä–æ —Å–ª–∞–±–æ—Å—Ç—å —Å–∏–ª—ã –∏ –ø—Ä–æ —Ç–æ, –∫–∞–∫ —Ç–∏—à–∏–Ω–∞ –∏–Ω–æ–≥–¥–∞ –≥—Ä–æ–º—á–µ —Å–ª–æ–≤.`,
`–ö–æ–º–µ–¥–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —á–∞—Å–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∑–º: —Å—Ü–µ–Ω—ã —Å–º–µ–Ω—è—é—Ç—Å—è –±—ã—Å—Ç—Ä–æ, —Ä–µ–ø–ª–∏–∫–∏ —Ç–æ—á–Ω—ã,
–∞ —Å–º–µ—Ö –≤–Ω–µ–∑–∞–ø–Ω–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–µ—Ä—å—ë–∑–Ω—ã–º. –ù–æ –≥–ª–∞–≤–Ω—ã–π —Å–µ–∫—Ä–µ—Ç —É—Å–ø–µ—Ö–∞ ‚Äî –≤ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–µ –≥–µ—Ä–æ—è:
—Ç–∞–ª–∞–Ω—Ç–ª–∏–≤—ã–π, –∂–∏–≤–æ–π, –Ω–µ—É–¥–æ–±–Ω—ã–π, –æ–Ω —Å–Ω–æ–≤–∞ –∏ —Å–Ω–æ–≤–∞ –ø—ã—Ç–∞–µ—Ç—Å—è —É–¥–µ—Ä–∂–∞—Ç—å —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ —Ç–∞–º,
–≥–¥–µ –æ–Ω–æ –Ω–∏–∫–æ–º—É –Ω–µ –≤—ã–≥–æ–¥–Ω–æ. –ò –∏–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –º—ã —É–∑–Ω–∞—ë–º –≤ –Ω—ë–º —Å–µ–±—è.`,
`–ò—Å—Ç–æ—Ä–∏—è –æ —Ç–æ–º, –∫–∞–∫ —á–µ–ª–æ–≤–µ–∫ —É—á–∏—Ç—Å—è –±—ã—Ç—å —á–µ—Å—Ç–Ω—ã–º ‚Äî –Ω–µ —Å –¥—Ä—É–≥–∏–º–∏, –∞ —Å —Å–æ–±–æ–π.
–ó–¥–µ—Å—å –Ω–µ—Ç ‚Äú–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö‚Äù –æ—Ç–≤–µ—Ç–æ–≤, –∑–∞—Ç–æ –µ—Å—Ç—å —Ç–æ—á–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã: —á—Ç–æ –º—ã –≤—ã–±–∏—Ä–∞–µ–º,
–∫–æ–≥–¥–∞ –Ω–∏–∫—Ç–æ –Ω–µ —Å–º–æ—Ç—Ä–∏—Ç? –ß—Ç–æ –æ—Å—Ç–∞—ë—Ç—Å—è –æ—Ç –ª—é–±–≤–∏, –µ—Å–ª–∏ –≤—ã–Ω—É—Ç—å –∏–∑ –Ω–µ—ë —Å—Ç—Ä–∞—Ö?
–°–ø–µ–∫—Ç–∞–∫–ª—å –∑–≤—É—á–∏—Ç –∫–∞–∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–Ω–µ–≤–Ω–∏–∫ ‚Äî –∏ –∏–Ω–æ–≥–¥–∞ –ø–æ–ø–∞–¥–∞–µ—Ç —Ç–æ—á–Ω–æ –≤ —Å–µ—Ä–¥—Ü–µ.`,
`–≠—Ç–æ —Å–ø–µ–∫—Ç–∞–∫–ª—å –æ –ø–∞–º—è—Ç–∏: –æ–Ω–∞ —É–º–µ–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–≤–µ—Ç –∏ —É–º–µ–µ—Ç —Ä–∞–Ω–∏—Ç—å.
–í –æ–±—ã—á–Ω–æ–º —Ä–∞–∑–≥–æ–≤–æ—Ä–µ –≤–¥—Ä—É–≥ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–∞—É–∑–∞, –∏ –≤ —ç—Ç–æ–π –ø–∞—É–∑–µ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è —Ü–µ–ª–∞—è –∂–∏–∑–Ω—å.
–ú—É–∑—ã–∫–∞, –≤–∑–≥–ª—è–¥, —à–∞–≥ ‚Äî –≤—Å—ë —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–∞–∂–Ω—ã–º. –ê —Å—Ü–µ–Ω–∞ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∫–æ–º–Ω–∞—Ç—É,
–≥–¥–µ –∫–∞–∂–¥—ã–π —É–∑–Ω–∞–µ—Ç —Å–≤–æ—é –∏—Å—Ç–æ—Ä–∏—é, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–∏–∫–æ–≥–¥–∞ –æ –Ω–µ–π –Ω–µ –≥–æ–≤–æ—Ä–∏–ª.`,
`–ù–µ–∂–Ω–∞—è, –Ω–æ –æ—Å—Ç—Ä–∞—è –∏—Å—Ç–æ—Ä–∏—è –æ –≤—ã–±–æ—Ä–µ –∏ —Ü–µ–Ω–µ –≤—ã–±–æ—Ä–∞.
–ì–µ—Ä–æ–∏ –±–µ–≥—É—Ç –æ—Ç —Å–µ–±—è, —Å–ø–æ—Ä—è—Ç —Å —Å—É–¥—å–±–æ–π, —Å–º–µ—é—Ç—Å—è –Ω–∞–¥ —Å—Ç—Ä–∞—Ö–æ–º, –Ω–æ –≤—Å—ë —Ä–∞–≤–Ω–æ
–∫–∞–∂–¥—ã–π —Ä–∞–∑ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∫ –æ–¥–Ω–æ–º—É: —á—Ç–æ –≤–∞–∂–Ω–µ–µ ‚Äî –ø–æ–±–µ–¥–∏—Ç—å –∏–ª–∏ –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –≥–ª–∞–≤–Ω–æ–µ?
–ò –∫–æ–≥–¥–∞ –∑–∞–Ω–∞–≤–µ—Å –æ–ø—É—Å–∫–∞–µ—Ç—Å—è, —Ç—ã –≤—ã—Ö–æ–¥–∏—à—å –¥—Ä—É–≥–∏–º ‚Äî —á—É—Ç—å —Ç–∏—à–µ, –Ω–æ —è—Å–Ω–µ–µ.`
  ];

  const aboutTemplate = () => ({
    director:"–ï–≤–≥–µ–Ω–∏–π –ü–∏—Å–∞—Ä–µ–≤",
    artist:"–ê–Ω–¥—Ä–µ–∞—Å —Ñ–æ–Ω –®–ª–∏–ø–ø–µ",
    producer:"–í–ª–∞–¥–∏–º–∏—Ä –ü—Ä—É–¥–∫–∏–Ω",
    music:"–¢–∏–º—É—Ä –ü–æ–ª—è–Ω—Å–∫–∏–π",
    light:"–°–µ—Ä–≥–µ–π –ù–µ–≤–≥–∞–¥–æ–≤—Å–∫–∏–π",
    ballet:"–ê–Ω–∂–µ–ª–∏–∫–∞ –ë–æ—Ä–∏—Å–æ–≤–∞",
    sound:"–°–µ—Ä–≥–µ–π –®–µ–≤—á–µ–Ω–∫–æ",
    video:"–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ë—Ä–∞—Ç–∏–Ω–æ–≤",
    assistant:"–õ—é–±–æ–≤—å –°–∫–∏—Ä–∫–æ",
  });

  const castPool = [
    ["–ò—Ä–∏–Ω–∞ –ì—Ä–∏—â–µ–Ω–∫–æ","–ö–∞—Ä–µ–Ω –°—Ç–æ—É–Ω"],
    ["–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –¢–µ–º–ª—è–∫","–ü–∞–æ–ª–æ"],
    ["–ò—Ä–∏–Ω–∞ –ú–µ–ª—å–Ω–∏–∫","–ì—Ä–∞—Ñ–∏–Ω—è"],
    ["–Æ–ª–∏—è –ë—Ä—É—Å–µ–Ω—Ü–µ–≤–∞","–°–ª—É–≥–∏ –ø—Ä–æ—Å—Ü–µ–Ω–∏—É–º–∞"],
    ["–°–µ—Ä–≥–µ–π –ù–µ–≤–≥–∞–¥–æ–≤—Å–∫–∏–π","–ê—Å—Ç—Ä–æ–≤"],
    ["–ê–Ω–Ω–∞ –†–æ–º–∞–Ω–æ–≤–∞","–í–µ—Ä–∞"],
    ["–ö–∏—Ä–∏–ª–ª –õ–µ–±–µ–¥–µ–≤","–ì—Ä—É—à–Ω–∏—Ü–∫–∏–π"],
    ["–û–ª—å–≥–∞ –°–µ–ª–µ–∑–Ω—ë–≤–∞","–ú–µ—Ä–∏"],
    ["–ú–∏—Ö–∞–∏–ª –ù–∞–∑–∞—Ä–æ–≤","–ü–µ—á–æ—Ä–∏–Ω"],
    ["–ü–∞–≤–µ–ª –ò–ª—å–∏–Ω","–í–µ–¥—É—â–∏–π"],
    ["–ö—Å–µ–Ω–∏—è –ê—Ä—Ç–µ–º—å–µ–≤–∞","–ì–æ—Å—Ç—å—è"],
    ["–ò–≥–æ—Ä—å –°–∞—Ñ–æ–Ω–æ–≤","–ö–æ–º–∏–∫"]
  ];

  const times = ["18:00","19:00","20:00","21:00","22:00"];

  const {start,end} = rangeToEndOfMonth();
  const events = [];
  let idx=0;

  for(let d=new Date(start); d<=end; d.setDate(d.getDate()+1)){
    for(let k=0;k<2;k++){
      const dateISO = iso(d);
      const id = `e_${dateISO}_${k}`;
      const r = seededRand(id);

      const title = titles[(idx + Math.floor(r()*titles.length)) % titles.length] + (k===1 ? " ‚Äî –í–µ—á–µ—Ä" : "");
      const poster = posters[Math.floor(r()*posters.length)];
      const desc = descriptions[Math.floor(r()*descriptions.length)];
      const t = times[Math.floor(r()*times.length)];

      const cast = [];
      const used = new Set();
      while(cast.length<4){
        const pick = castPool[Math.floor(r()*castPool.length)];
        const key = pick[0]+"|"+pick[1];
        if(used.has(key)) continue;
        used.add(key);
        cast.push({actor:pick[0], role:pick[1]});
      }

      events.push({
        id, title,
        city:"–ú–æ—Å–∫–≤–∞",
        venue:"–ú–æ—Å–∫–≤–∞, —É–ª. –ë–æ–ª—å—à–∞—è –°–∞–¥–æ–≤–∞—è 6",
        date: dateISO,
        time: t,
        poster,
        about: aboutTemplate(),
        cast,
        description: desc
      });
      idx++;
    }
  }
  saveEvents({events});
}

/** ========= MIGRATION (–µ—Å–ª–∏ —Å–æ–±—ã—Ç–∏—è —Å—Ç–∞—Ä—ã–µ –∏ –ø—É—Å—Ç—ã–µ) ========= */
function enrichIfMissing(e){
  const r = seededRand(e.id || (e.title||"x"));

  // about
  if(!e.about || !Object.keys(e.about).length){
    e.about = {
      director:"–ï–≤–≥–µ–Ω–∏–π –ü–∏—Å–∞—Ä–µ–≤",
      artist:"–ê–Ω–¥—Ä–µ–∞—Å —Ñ–æ–Ω –®–ª–∏–ø–ø–µ",
      producer:"–í–ª–∞–¥–∏–º–∏—Ä –ü—Ä—É–¥–∫–∏–Ω",
      music:"–¢–∏–º—É—Ä –ü–æ–ª—è–Ω—Å–∫–∏–π",
      light:"–°–µ—Ä–≥–µ–π –ù–µ–≤–≥–∞–¥–æ–≤—Å–∫–∏–π",
      ballet:"–ê–Ω–∂–µ–ª–∏–∫–∞ –ë–æ—Ä–∏—Å–æ–≤–∞",
      sound:"–°–µ—Ä–≥–µ–π –®–µ–≤—á–µ–Ω–∫–æ",
      video:"–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ë—Ä–∞—Ç–∏–Ω–æ–≤",
      assistant:"–õ—é–±–æ–≤—å –°–∫–∏—Ä–∫–æ",
    };
  }
  // cast
  if(!Array.isArray(e.cast) || !e.cast.length){
    const pool = [
      ["–ò—Ä–∏–Ω–∞ –ì—Ä–∏—â–µ–Ω–∫–æ","–ö–∞—Ä–µ–Ω –°—Ç–æ—É–Ω"],
      ["–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –¢–µ–º–ª—è–∫","–ü–∞–æ–ª–æ"],
      ["–ò—Ä–∏–Ω–∞ –ú–µ–ª—å–Ω–∏–∫","–ì—Ä–∞—Ñ–∏–Ω—è"],
      ["–Æ–ª–∏—è –ë—Ä—É—Å–µ–Ω—Ü–µ–≤–∞","–°–ª—É–≥–∏ –ø—Ä–æ—Å—Ü–µ–Ω–∏—É–º–∞"],
      ["–°–µ—Ä–≥–µ–π –ù–µ–≤–≥–∞–¥–æ–≤—Å–∫–∏–π","–ê—Å—Ç—Ä–æ–≤"],
      ["–ê–Ω–Ω–∞ –†–æ–º–∞–Ω–æ–≤–∞","–í–µ—Ä–∞"],
      ["–ö–∏—Ä–∏–ª–ª –õ–µ–±–µ–¥–µ–≤","–ì—Ä—É—à–Ω–∏—Ü–∫–∏–π"],
      ["–û–ª—å–≥–∞ –°–µ–ª–µ–∑–Ω—ë–≤–∞","–ú–µ—Ä–∏"],
      ["–ú–∏—Ö–∞–∏–ª –ù–∞–∑–∞—Ä–æ–≤","–ü–µ—á–æ—Ä–∏–Ω"],
      ["–ü–∞–≤–µ–ª –ò–ª—å–∏–Ω","–í–µ–¥—É—â–∏–π"],
      ["–ö—Å–µ–Ω–∏—è –ê—Ä—Ç–µ–º—å–µ–≤–∞","–ì–æ—Å—Ç—å—è"],
      ["–ò–≥–æ—Ä—å –°–∞—Ñ–æ–Ω–æ–≤","–ö–æ–º–∏–∫"]
    ];
    e.cast = [];
    const used = new Set();
    while(e.cast.length<4){
      const pick = pool[Math.floor(r()*pool.length)];
      const key = pick[0]+"|"+pick[1];
      if(used.has(key)) continue;
      used.add(key);
      e.cast.push({actor:pick[0], role:pick[1]});
    }
  }
  // description
  if(!e.description || String(e.description).trim().length < 40){
    const descs = [
`–ö–æ–º–µ–¥–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —á–∞—Å–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∑–º: —Å—Ü–µ–Ω—ã —Å–º–µ–Ω—è—é—Ç—Å—è –±—ã—Å—Ç—Ä–æ, —Ä–µ–ø–ª–∏–∫–∏ —Ç–æ—á–Ω—ã,
–∞ —Å–º–µ—Ö –≤–Ω–µ–∑–∞–ø–Ω–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–µ—Ä—å—ë–∑–Ω—ã–º. –ù–æ –≥–ª–∞–≤–Ω—ã–π —Å–µ–∫—Ä–µ—Ç —É—Å–ø–µ—Ö–∞ ‚Äî –≤ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–µ –≥–µ—Ä–æ—è:
—Ç–∞–ª–∞–Ω—Ç–ª–∏–≤—ã–π, –∂–∏–≤–æ–π, –Ω–µ—É–¥–æ–±–Ω—ã–π, –æ–Ω —Å–Ω–æ–≤–∞ –∏ —Å–Ω–æ–≤–∞ –ø—ã—Ç–∞–µ—Ç—Å—è —É–¥–µ—Ä–∂–∞—Ç—å —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ —Ç–∞–º,
–≥–¥–µ –æ–Ω–æ –Ω–∏–∫–æ–º—É –Ω–µ –≤—ã–≥–æ–¥–Ω–æ.`,
`–ò—Å—Ç–æ—Ä–∏—è –æ —Ç–æ–º, –∫–∞–∫ —á–µ–ª–æ–≤–µ–∫ —É—á–∏—Ç—Å—è –±—ã—Ç—å —á–µ—Å—Ç–Ω—ã–º ‚Äî –Ω–µ —Å –¥—Ä—É–≥–∏–º–∏, –∞ —Å —Å–æ–±–æ–π.
–ó–¥–µ—Å—å –Ω–µ—Ç ‚Äú–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö‚Äù –æ—Ç–≤–µ—Ç–æ–≤, –∑–∞—Ç–æ –µ—Å—Ç—å —Ç–æ—á–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã: —á—Ç–æ –º—ã –≤—ã–±–∏—Ä–∞–µ–º,
–∫–æ–≥–¥–∞ –Ω–∏–∫—Ç–æ –Ω–µ —Å–º–æ—Ç—Ä–∏—Ç? –°–ø–µ–∫—Ç–∞–∫–ª—å –∑–≤—É—á–∏—Ç –∫–∞–∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–Ω–µ–≤–Ω–∏–∫.`,
`–≠—Ç–æ —Å–ø–µ–∫—Ç–∞–∫–ª—å –æ –ø–∞–º—è—Ç–∏: –æ–Ω–∞ —É–º–µ–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–≤–µ—Ç –∏ —É–º–µ–µ—Ç —Ä–∞–Ω–∏—Ç—å.
–í –æ–±—ã—á–Ω–æ–º —Ä–∞–∑–≥–æ–≤–æ—Ä–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–∞—É–∑–∞, –∏ –≤ —ç—Ç–æ–π –ø–∞—É–∑–µ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è —Ü–µ–ª–∞—è –∂–∏–∑–Ω—å.`,
`–ù–µ–∂–Ω–∞—è, –Ω–æ –æ—Å—Ç—Ä–∞—è –∏—Å—Ç–æ—Ä–∏—è –æ –≤—ã–±–æ—Ä–µ –∏ —Ü–µ–Ω–µ –≤—ã–±–æ—Ä–∞.
–ì–µ—Ä–æ–∏ —Å–ø–æ—Ä—è—Ç —Å —Å—É–¥—å–±–æ–π, —Å–º–µ—é—Ç—Å—è –Ω–∞–¥ —Å—Ç—Ä–∞—Ö–æ–º, –Ω–æ –≤—Å—ë —Ä–∞–≤–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∫ –æ–¥–Ω–æ–º—É: —á—Ç–æ –≤–∞–∂–Ω–µ–µ?`
    ];
    e.description = descs[Math.floor(r()*descs.length)];
  }
  // time (–æ–¥–Ω–æ –≤—Ä–µ–º—è)
  if(!e.time){
    const times = ["18:00","19:00","20:00","21:00","22:00"];
    e.time = times[Math.floor(r()*times.length)];
  }
  // venue/city
  e.city = e.city || "–ú–æ—Å–∫–≤–∞";
  e.venue = e.venue || "–ú–æ—Å–∫–≤–∞, —É–ª. –ë–æ–ª—å—à–∞—è –°–∞–¥–æ–≤–∞—è 6";
  return e;
}

seedEventsIfMissing();

const id = qs("id");
let store = loadEvents();
const hidden = hiddenSet();
let e = store.events.find(x=>x.id===id);

if(!e || hidden.has(id)){
  document.body.innerHTML = "<div style='padding:18px;font-family:Inter'>–°–æ–±—ã—Ç–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∏–ª–∏ —Å–∫—Ä—ã—Ç–æ. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –ê—Ñ–∏—à—É.</div>";
  throw new Error("not found");
}

// –ø–æ–¥–ª–µ—á–∏–º –µ—Å–ª–∏ —Å—Ç–∞—Ä–æ–µ/–ø—É—Å—Ç–æ–µ
e = enrichIfMissing(e);
// —Å–æ—Ö—Ä–∞–Ω–∏–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ
store.events = store.events.map(x=> x.id===e.id ? e : x);
saveEvents(store);

// render
document.title = e.title + " ‚Äî –¢–µ–∞—Ç—Ä";
document.getElementById("poster").src = e.poster;
document.getElementById("title").textContent = e.title;
document.getElementById("meta").textContent = `${e.city}, ${formatRU(e.date)}, ${e.time}`;
document.getElementById("venue").textContent = e.venue;

// buy link (–≤—Å–µ–≥–¥–∞)
document.getElementById("goBuy").href = `buy.html?id=${encodeURIComponent(e.id)}`;

const labels = {
  director:"–†–µ–∂–∏—Å—Å–µ—Ä-–ø–æ—Å—Ç–∞–Ω–æ–≤—â–∏–∫",
  artist:"–•—É–¥–æ–∂–Ω–∏–∫-–ø–æ—Å—Ç–∞–Ω–æ–≤—â–∏–∫",
  producer:"–ü—Ä–æ–¥—é—Å–µ—Ä—ã",
  costume:"–•—É–¥–æ–∂–Ω–∏–∫ –ø–æ –∫–æ—Å—Ç—é–º–∞–º",
  music:"–ú—É–∑—ã–∫–∞–ª—å–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ",
  light:"–•—É–¥–æ–∂–Ω–∏–∫ –ø–æ –æ—Å–≤–µ—â–µ–Ω–∏—é",
  ballet:"–ë–∞–ª–µ—Ç–º–µ–π—Å—Ç–µ—Ä",
  sound:"–ó–≤—É–∫–æ—Ä–µ–∂–∏—Å—Å–µ—Ä",
  video:"–í–∏–¥–µ–æ",
  assistant:"–ü–æ–º–æ—â–Ω–∏–∫ —Ä–µ–∂–∏—Å—Å–µ—Ä–∞",
};

const aboutEl = document.getElementById("about");
aboutEl.innerHTML = "";
Object.entries(e.about||{}).forEach(([k,v])=>{
  const row=document.createElement("div");
  row.innerHTML = `<b>${labels[k]||k}</b> ‚Äî ${v}`;
  aboutEl.appendChild(row);
});

document.getElementById("cast").innerHTML =
  (e.cast||[]).map(x=>`<div><b>${x.actor}</b> - ${x.role}</div>`).join("");

document.getElementById("desc").textContent = e.description || "";
</script>
</body>
</html>
